const path = require('path')
const fs = require('fs')

module.exports = function creator(virtualPath, context = __dirname) {


  return function staticFileHandler(req, res,next) {
    let filepath = path.join(context, virtualPath, !req.url || req.url == '/' ? 'index.html' : req.url)

    fs.exists(filepath,function(exists){
      if(exists){
        fs.createReadStream(filepath).pipe(res)
        next(null)
      }else{
        next()
      }
    })
  }
}